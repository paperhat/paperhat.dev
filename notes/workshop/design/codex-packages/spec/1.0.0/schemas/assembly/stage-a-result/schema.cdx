<Schema
	id="codex:assembly:stage-a-result"
	version="1.0.0"
	versionScheme="$Semver"
	authoringMode="$SimplifiedMode"
	compatibilityClass="$Initial"
	namespace="adaptive-stage-a-result"
	title="Stage A Result Schema"
	description="Deterministic Stage A output envelope."
>
	<ConceptDefinitions>
		<ConceptDefinition
			id="codex:assembly:stage-a-result:StageAResult"
			name="StageAResult"
			conceptKind="$Semantic"
			entityEligibility="$MustNotBeEntity"
		>
			<ContentRules>
				<ForbidsContent />
			</ContentRules>

			<TraitRules>
				<RequiresTrait name="id" />

				<RequiresTrait name="status" />

				<AllowsTrait name="error" />
			</TraitRules>

			<ChildRules>
				<AllowsChildConcept conceptSelector="SelectedActions" />

				<AllowsChildConcept conceptSelector="Delta" />
			</ChildRules>
		</ConceptDefinition>

		<ConceptDefinition
			id="codex:assembly:stage-a-result:SelectedActions"
			name="SelectedActions"
			conceptKind="$Structural"
			entityEligibility="$MustNotBeEntity"
		>
			<ContentRules>
				<ForbidsContent />
			</ContentRules>

			<ChildRules>
				<AllowsChildConcept conceptSelector="Action" />
			</ChildRules>
		</ConceptDefinition>

		<ConceptDefinition
			id="codex:assembly:stage-a-result:Action"
			name="Action"
			conceptKind="$Structural"
			entityEligibility="$MustNotBeEntity"
		>
			<ContentRules>
				<ForbidsContent />
			</ContentRules>

			<TraitRules>
				<RequiresTrait name="iri" />
			</TraitRules>
		</ConceptDefinition>

		<ConceptDefinition
			id="codex:assembly:stage-a-result:Delta"
			name="Delta"
			conceptKind="$Structural"
			entityEligibility="$MustNotBeEntity"
		>
			<ContentRules>
				<ForbidsContent />
			</ContentRules>

			<ChildRules>
				<AllowsChildConcept conceptSelector="Remove" />

				<AllowsChildConcept conceptSelector="Add" />
			</ChildRules>
		</ConceptDefinition>

		<ConceptDefinition
			id="codex:assembly:stage-a-result:Remove"
			name="Remove"
			conceptKind="$Structural"
			entityEligibility="$MustNotBeEntity"
		>
			<ContentRules>
				<ForbidsContent />
			</ContentRules>

			<TraitRules>
				<RequiresTrait name="triple" />
			</TraitRules>
		</ConceptDefinition>

		<ConceptDefinition
			id="codex:assembly:stage-a-result:Add"
			name="Add"
			conceptKind="$Structural"
			entityEligibility="$MustNotBeEntity"
		>
			<ContentRules>
				<ForbidsContent />
			</ContentRules>

			<TraitRules>
				<RequiresTrait name="triple" />
			</TraitRules>
		</ConceptDefinition>
	</ConceptDefinitions>

	<TraitDefinitions>
		<TraitDefinition
			name="id"
			defaultValueType="$Text"
			cardinality="$Single"
		/>

		<TraitDefinition
			name="status"
			defaultValueType="$EnumeratedToken"
			cardinality="$Single"
		>
			<AllowedValues>
				<ValueIsOneOf values="$ok,$error" />
			</AllowedValues>
		</TraitDefinition>

		<TraitDefinition
			name="error"
			defaultValueType="$Text"
			cardinality="$Single"
		/>

		<TraitDefinition
			name="iri"
			defaultValueType="$IriReference"
			cardinality="$Single"
			isReferenceTrait="true"
		/>

		<TraitDefinition
			name="triple"
			defaultValueType="$Text"
			cardinality="$Single"
		/>
	</TraitDefinitions>
</Schema>
